---
# tasks file for setup-nfs-server
- name: ensure NFS Server packages are installed
  yum:
    state: present
    name: "{{ item }}"
  with_items:
    - nfs-utils
    - rpcbind
    
- name: ensure {{ exportdir }} is exported
  lineinfile:
    path: /etc/exports
    regexp: '^{{ exportdir }} '
    line: '{{ exportdir }} {{ exportparameter }}'

- name: ensure firewall ports 2049/tcp are open
  firewalld:
    port: 2049/tcp
    permanent: true
    state: enabled
 
- name: ensure nfs Service are running
  service:
    name: "{{ item }}"
    state: started
    enabled: yes
  with_items:
    - rpcbind
    - nfs

